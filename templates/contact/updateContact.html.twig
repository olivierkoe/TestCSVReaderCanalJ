{% extends 'base.html.twig' %}

{% block title %}Ajouter un contact{% endblock %}

{% block body %}
<div>
    <section class="container">
        <div class="row">
        <h1>Modifier un contact </h1>
    </table>
    <div class="mt-3">
        <script>
        document.getElementById("ajouter_contact").addEventListener("click", function() {
            // Redirection vers la page d'accueil
            window.location.href = "{{ path('main') }}";
        });
        </script>
    </div>
        {{ form_start(UpdateContact) }}

            <fieldset class="mb-3">
                <legend class="mb-3">Le nouveau contact</legend>
                <table border="1">
                 <tr> 
                 {% if UpdateContact == null %}

                 {% else %}
                    <th>{{ form_row(UpdateContact.email) }} </th>
                    <th>{{ form_row(UpdateContact.nom) }} </th>
                    <th>{{ form_row(UpdateContact.adresse) }} </th>
                    <th>{{ form_row(UpdateContact.prenom) }} </th>
                {% endif %}
                 </tr>
                </table>
            </fieldset>
            <form class="mb-3" action="{{ path('contact') }}" method="POST">
                <select name="email" id="email">
                    {% for contact in contacts %}
                        <option value="{{ contact.id }}"><p>{{ contact.id }} {{ contact.email }}</p></option>
                    {% endfor %}
                <button class="mb-3" type="submit" name="telecharger" id="" value="1">Télécharger fichier CSV</button>
                <button type="submit" class="mb-3" id="updateContact">Modifier le contact</button>
                </select>
            </form>
        {{ form_end(UpdateContact) }}
    </div>
<script>
    // Écoute l'événement de soumission du formulaire
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelector('form').addEventListener('submit', function(event) {
            event.preventDefault(); // Empêche la soumission par défaut du formulaire

            // Récupère la valeur de l'email depuis le champ de formulaire
            var email = document.getElementById("email").value;

            // Redirige vers la page de mise à jour du contact avec l'email comme paramètre
             window.location.href = "{{ path('updateContact') }}?email=" + encodeURIComponent(email);
        });
    });
</script>
{% endblock %}